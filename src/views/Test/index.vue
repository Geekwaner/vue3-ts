<script setup lang="ts">
//

import { ref, onUnmounted } from 'vue';

const count = ref(0);

// é…åˆ ts è®¾ç½®0ï¼Œå®šæ—¶å™¨ç±»å‹æœ¬è´¨æ˜¯æ•°å­—
let timer = 0;
const start = (time = 60) => {
  // ä¸€å¼€å§‹æ—¶å€™ï¼Œå°±åˆ¤æ–­ï¼Œæœ‰å®šæ—¶å™¨ï¼Œå°±ä¸è¦æ‰§è¡Œåé¢çš„ä»£ç äº†
  if (count.value) return;

  count.value = time;
  timer = setInterval(() => {
    count.value--;
    console.log('count.value -----> ', count.value);

    // åˆ°0æ—¶ï¼Œæ¸…ç†å®šæ—¶å™¨
    if (count.value <= 0) {
      clearInterval(timer);
    }
  }, 1000);
};

// ä¼˜åŒ–ï¼šç¦»å¼€é¡µé¢æ—¶ï¼Œæ¸…ç†å®šæ—¶å™¨
onUnmounted(() => clearInterval(timer));
</script>

<template>
  <h1>Hello vue3 + tsğŸ‘</h1>
  <!-- startå‡½æ•°è®°å¾—è¦è°ƒç”¨ï¼Œå¦åˆ™vue3ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œå¹¶ä¸”ä¼ é€’å½“å‰å¯¹è±¡ï¼Œå‚æ•°å°±ä¸å¯¹äº† -->
  <button @click="start(50)">{{ count === 0 ? 'å‘é€éªŒè¯ç ' : count }}</button>
</template>

<style lang="less" scoped></style>
